{% load static %}
<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8" />
  <title>My Submissions | Team Expense Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <link href="{% static 'css/tailwind.min.css' %}" rel="stylesheet" />
  <link href="https://fonts.cdnfonts.com/css/mona-sans" rel="stylesheet" />
  <style>
    :root { --brand:#075131; }
    body { font-family: 'Mona-Sans', ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji'; }
    .brand-bg { background-color: var(--brand); }
    .brand-bg-hover:hover { background-color: #06412a; }
    .brand-text { color: var(--brand); }
    .brand-border { border-color: var(--brand); }
  </style>
</head>
<body class="min-h-screen h-full bg-gray-50 text-gray-900 dark:bg-gray-900 dark:text-gray-100 antialiased">

  <!-- Navbar -->
  <nav id="appHeader" class="sticky top-0 z-50 bg-white/90 backdrop-blur border-b border-gray-200 shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="h-16 flex items-center justify-between">
        <button id="sidebarToggle" class="lg:hidden inline-flex items-center justify-center h-9 w-9 rounded-lg border border-gray-300 bg-white text-gray-700 mr-2">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 6h16M4 12h16M4 18h16"/></svg>
        </button>
        <a href="{% url 'dashboard' %}" class="flex items-center gap-3 group">
          <span class="inline-flex h-9 w-9 items-center justify-center rounded-lg brand-bg text-white shadow-sm group-hover:shadow transition">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M9 17v-2a4 4 0 014-4h5a4 4 0 014 4v2" />
              <path d="M3 7a4 4 0 014-4h10a4 4 0 014 4v10a4 4 0 01-4 4H7a4 4 0 01-4-4V7z" />
            </svg>
          </span>
          <span class="text-lg font-semibold tracking-tight">Team Expense Tracker</span>
        </a>
        <div class="flex items-center gap-3">
          <span class="hidden sm:block text-sm font-medium">üë§ {{ request.user.first_name }}</span>
          <form method="post" action="{% url 'logout' %}">
            {% csrf_token %}
            <button type="submit" class="inline-flex items-center rounded-lg brand-bg brand-bg-hover text-white px-4 py-2 text-sm font-semibold shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 dark:focus-visible:ring-offset-gray-800 transition" aria-label="Logout">
              Logout
            </button>
          </form>
        </div>
      </div>
    </div>
  </nav>

  <div class="flex">
    <!-- Sidebar -->
    <aside id="sidebar" class="hidden lg:block w-64 h-screen text-white shadow-lg" style="background-color: var(--brand);">
      <div class="p-6">
        <!-- <div class="mb-8">
          <h2 class="text-xl font-semibold">Welcome</h2>
          <p class="text-sm text-gray-400">{{ request.user.first_name }}</p>
        </div> -->
        <nav class="space-y-2 text-sm">
          <a href="{% url 'dashboard' %}" class="flex items-center gap-2 px-4 py-3 w-full rounded-lg border border-white/30 transition {% if request.resolver_match.url_name == 'dashboard' %}bg-white text-green-700 font-medium{% else %}hover:bg-white/10 text-white/90{% endif %}">
            <span>üìä</span> Dashboard
          </a>
          <a href="{% url 'add_expense' %}" class="flex items-center gap-2 px-4 py-3 w-full rounded-lg border border-white/30 transition {% if request.resolver_match.url_name == 'add_expense' %}bg-white text-green-700 font-medium{% else %}hover:bg-white/10 text-white/90{% endif %}">
            <span>‚ûï</span> Add Expense
          </a>
          <a href="{% url 'reports' %}" class="flex items-center gap-2 px-4 py-3 w-full rounded-lg border border-white/30 transition {% if request.resolver_match.url_name == 'reports' %}bg-white text-green-700 font-medium{% else %}hover:bg-white/10 text-white/90{% endif %}">
            <span>üìà</span> Reports
          </a>
          <a href="{% url 'my_submissions' %}" class="flex items-center gap-2 px-4 py-3 w-full rounded-lg border border-white/30 transition {% if request.resolver_match.url_name == 'my_submissions' %}bg-white text-green-700 font-medium{% else %}hover:bg-white/10 text-white/90{% endif %}">
            <span>üìÅ</span> My Submissions
          </a>
          <a href="{% url 'invoice_generator' %}" class="flex items-center gap-2 px-4 py-3 w-full rounded-lg border border-white/30 transition {% if request.resolver_match.url_name == 'invoice_generator' %}bg-white text-green-700 font-medium{% else %}hover:bg-white/10 text-white/90{% endif %}">
            <span>üßæ</span> Invoice Generator
          </a>
        </nav>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1">
      <div class="max-w-7xl mx-auto p-6 lg:p-10">
        <div class="mb-6">
          <h1 class="text-3xl font-bold tracking-tight">My Expense Submissions</h1>
          <p class="mt-1 text-gray-600 dark:text-gray-300">View and manage your submitted expenses.</p>
        </div>

        {% if expenses %}
        <div class="overflow-x-auto rounded-xl bg-white dark:bg-gray-800 shadow ring-1 ring-gray-200 dark:ring-white/10">
          <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
            <thead class="bg-gray-50 dark:bg-gray-700/50 text-gray-600 dark:text-gray-300 text-xs uppercase tracking-wide">
              <tr>
                <th scope="col" class="py-3 px-4 text-left">Title</th>
                <th scope="col" class="py-3 px-4 text-left">Amount</th>
                <th scope="col" class="py-3 px-4 text-left">Category</th>
                <th scope="col" class="py-3 px-4 text-left">Date</th>
                <th scope="col" class="py-3 px-4 text-left">Invoice</th>
                <th scope="col" class="py-3 px-4 text-left">Actions</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-200 dark:divide-gray-700 text-sm">
              {% for exp in expenses %}
              <tr class="hover:bg-gray-50/50 dark:hover:bg-gray-700/30">
                <td class="py-3 px-4">{{ exp.title }}</td>
                <td class="py-3 px-4">‚Çπ{{ exp.amount }}</td>
                <td class="py-3 px-4">{{ exp.category }}</td>
                <td class="py-3 px-4">{{ exp.date }}</td>
                <td class="py-3 px-4">
                  {% if exp.invoice %}
                    <a href="{{ exp.invoice.url }}" target="_blank" class="text-indigo-600 dark:text-indigo-400 hover:underline text-sm" download>Download</a>
                  {% else %}
                    <span class="text-gray-400 text-sm">No File</span>
                  {% endif %}
                </td>
                <td class="py-3 px-4 space-x-2">
                  <a href="{% url 'edit_expense' exp.id %}" class="text-blue-600 dark:text-blue-400 hover:underline text-sm">Edit</a>
                  <form method="POST" action="{% url 'delete_expense' exp.id %}" class="inline" onsubmit="return confirm('Are you sure?');">
                    {% csrf_token %}
                    <button type="submit" class="text-red-600 dark:text-red-400 hover:underline text-sm">Delete</button>
                  </form>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        {% else %}
          <p class="text-gray-600 dark:text-gray-300">No submissions found.</p>
        {% endif %}
      </div>
    </main>
  </div>
  <script>
    // Sidebar toggle for mobile
    (function() {
      const sidebarToggle = document.getElementById('sidebarToggle');
      const sidebar = document.getElementById('sidebar');
      
      if (sidebarToggle && sidebar) {
        sidebarToggle.addEventListener('click', function() {
          sidebar.classList.toggle('hidden');
        });
      }
    })();

    // Header background on scroll
    (function() {
      const header = document.getElementById('appHeader');
      const onScroll = () => {
        if (window.scrollY > 10) {
          header.classList.add('bg-white','shadow-md');
        } else {
          header.classList.remove('bg-white','shadow-md');
        }
      };
      window.addEventListener('scroll', onScroll, { passive: true });
      onScroll();
    })();
  </script>
</body>
</html>